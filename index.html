<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Beb√™ Smart - O primeiro app com IA especialista em beb√™s</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Arial', sans-serif;
            line-height: 1.6;
            color: #333;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }

        .card {
            background: white;
            border-radius: 15px;
            padding: 30px;
            margin: 20px 0;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
        }

        .header {
            text-align: center;
            color: white;
            margin-bottom: 30px;
        }

        .header h1 {
            font-size: 2.5rem;
            margin-bottom: 10px;
        }

        .ai-badge {
            background: linear-gradient(135deg, #ff6b6b, #feca57);
            color: white;
            padding: 5px 15px;
            border-radius: 20px;
            font-size: 0.9rem;
            font-weight: bold;
            display: inline-block;
            margin: 10px 0;
        }

        .demo-badge {
            background: #28a745;
            color: white;
            padding: 10px;
            border-radius: 10px;
            margin-top: 15px;
            text-align: center;
        }

        /* DISCLAIMERS LEGAIS */
        .medical-disclaimer {
            background: #f8d7da;
            border: 2px solid #dc3545;
            border-radius: 10px;
            padding: 15px;
            margin: 20px 0;
            text-align: center;
        }

        .emergency-disclaimer {
            background: #d4edda;
            border: 2px solid #28a745;
            border-radius: 10px;
            padding: 15px;
            margin: 20px 0;
            text-align: center;
        }

        .section-disclaimer {
            background: #e2e3e5;
            border-left: 4px solid #6c757d;
            padding: 12px;
            margin: 15px 0;
            font-size: 13px;
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: bold;
            color: #555;
        }

        .form-group input,
        .form-group select,
        .form-group textarea {
            width: 100%;
            padding: 12px;
            border: 2px solid #ddd;
            border-radius: 8px;
            font-size: 16px;
            transition: border-color 0.3s;
            font-family: inherit;
        }

        .form-group input:focus,
        .form-group select:focus,
        .form-group textarea:focus {
            outline: none;
            border-color: #667eea;
        }

        .btn {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 15px 30px;
            border: none;
            border-radius: 8px;
            font-size: 16px;
            cursor: pointer;
            transition: transform 0.2s;
            width: 100%;
            margin: 10px 0;
        }

        .btn:hover {
            transform: translateY(-2px);
        }

        .btn:disabled {
            opacity: 0.6;
            cursor: not-allowed;
            transform: none;
        }

        .btn-secondary {
            background: #6c757d;
        }

        .btn-legal {
            background: #17a2b8;
            width: auto;
            padding: 8px 16px;
            margin: 5px;
            text-decoration: none;
            display: inline-block;
            font-size: 12px;
        }

        .hidden {
            display: none;
        }

        .error {
            background: #f8d7da;
            color: #721c24;
            padding: 15px;
            border-radius: 8px;
            margin: 15px 0;
            border: 1px solid #f5c6cb;
        }

        .success {
            background: #d4edda;
            color: #155724;
            padding: 15px;
            border-radius: 8px;
            margin: 15px 0;
            border: 1px solid #c3e6cb;
        }

        .success h4 {
            margin: 0 0 10px 0;
            color: #155724;
        }

        .success p {
            margin: 5px 0;
        }

        /* Modal de documentos legais */
        .legal-modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.8);
            z-index: 1000;
            overflow-y: auto;
            padding: 20px;
        }

        .legal-modal-content {
            background: white;
            margin: 0 auto;
            padding: 30px;
            border-radius: 15px;
            max-width: 900px;
            max-height: 90vh;
            overflow-y: auto;
        }

        .legal-modal h3 {
            color: #dc3545;
            margin-bottom: 20px;
        }

        .legal-modal h4 {
            color: #495057;
            margin: 20px 0 10px 0;
        }

        .legal-modal ul {
            margin-left: 20px;
            margin-bottom: 15px;
        }

        @media (max-width: 768px) {
            .container {
                padding: 10px;
            }
            
            .header h1 {
                font-size: 2rem;
            }

            .legal-modal {
                padding: 10px;
            }

            .legal-modal-content {
                padding: 20px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üë∂ Beb√™ Smart</h1>
            <div class="ai-badge">ü§ñ POWERED BY AI</div>
            <p>O primeiro app brasileiro com IA especialista em beb√™s</p>
            <div class="demo-badge">
                <strong>üöÄ SISTEMA REAL FUNCIONANDO</strong> - Cadastro + WhatsApp + IA integrados
            </div>
        </div>

        <!-- DISCLAIMER M√âDICO PRINCIPAL -->
        <div class="medical-disclaimer">
            <h4 style="color: #721c24; margin-bottom: 10px;">‚ö†Ô∏è AVISO M√âDICO IMPORTANTE</h4>
            <p style="color: #721c24; margin: 0; font-size: 14px;">
                <strong>O Beb√™ Smart √© uma ferramenta APENAS educativa e organizacional.</strong><br>
                N√ÉO oferece servi√ßos m√©dicos, diagn√≥sticos ou tratamentos. <strong>Sempre consulte pediatras qualificados</strong> para quest√µes de sa√∫de do seu beb√™.
                <br><br>
                <a href="#" onclick="showLegalModal('termos')" class="btn-legal">üìã Termos de Uso</a>
                <a href="#" onclick="showLegalModal('privacidade')" class="btn-legal">üîí Pol√≠tica de Privacidade</a>
            </p>
        </div>

        <!-- DISCLAIMER DE EMERG√äNCIA -->
        <div class="emergency-disclaimer">
            <h5 style="color: #155724; margin-bottom: 8px;">üö® EM EMERG√äNCIAS M√âDICAS</h5>
            <p style="color: #155724; margin: 0; font-size: 13px;">
                <strong>NUNCA use este app em emerg√™ncias!</strong><br>
                Ligue: <strong>192 (SAMU)</strong> ou <strong>193 (Bombeiros)</strong> ‚Ä¢ Procure o pronto-socorro mais pr√≥ximo
            </p>
        </div>

        <!-- Tela de Login -->
        <div id="loginScreen" class="card">
            <h2 style="text-align: center; margin-bottom: 30px;">Entre na sua conta</h2>
            
            <div class="section-disclaimer">
                <strong>üîí Prote√ß√£o de Dados:</strong> Seus dados s√£o protegidos conforme LGPD. 
                <a href="#" onclick="showLegalModal('privacidade')" style="color: #17a2b8;">Saiba mais</a>
            </div>

            <div class="form-group">
                <label>Email:</label>
                <input type="email" id="loginEmail" placeholder="demo@bebesmart.com.br">
            </div>
            <div class="form-group">
                <label>Senha:</label>
                <input type="password" id="loginPassword" placeholder="123456">
            </div>
            <button class="btn" onclick="login()">Entrar</button>
            <button class="btn btn-secondary" onclick="showRegister()">Criar conta</button>
            <div id="loginError" class="error hidden"></div>
            <div style="background: #e3f2fd; padding: 15px; border-radius: 8px; margin-top: 15px;">
                <strong>üß™ Modo Demo:</strong><br>
                Email: demo@bebesmart.com.br<br>
                Senha: 123456
            </div>
        </div>

        <!-- Tela de Cadastro -->
        <div id="registerScreen" class="card hidden">
            <h2 style="text-align: center; margin-bottom: 30px;">Criar conta</h2>
            
            <div class="section-disclaimer">
                <strong>üë∂ Prote√ß√£o Especial:</strong> Dados de crian√ßas recebem prote√ß√£o especial conforme LGPD. 
                Apenas pais/respons√°veis podem cadastrar informa√ß√µes dos filhos.
            </div>

            <div class="form-group">
                <label>Nome completo:</label>
                <input type="text" id="registerName" placeholder="Seu nome completo">
            </div>
            <div class="form-group">
                <label>Email:</label>
                <input type="email" id="registerEmail" placeholder="seu@email.com">
            </div>
            <div class="form-group">
                <label>Telefone (WhatsApp):</label>
                <input type="tel" id="registerPhone" placeholder="5511999999999">
            </div>
            <div class="form-group">
                <label>Senha:</label>
                <input type="password" id="registerPassword" placeholder="M√≠nimo 6 caracteres">
            </div>
            
            <div style="background: #fff3cd; padding: 12px; border-radius: 8px; margin: 15px 0; font-size: 13px;">
                <input type="checkbox" id="acceptTerms" required> 
                <label for="acceptTerms" style="display: inline; margin-left: 8px;">
                    Aceito os <a href="#" onclick="showLegalModal('termos')">Termos de Uso</a> e 
                    <a href="#" onclick="showLegalModal('privacidade')">Pol√≠tica de Privacidade</a>
                </label>
            </div>
            
            <button class="btn" onclick="register()">Criar conta</button>
            <button class="btn btn-secondary" onclick="showLogin()">J√° tenho conta</button>
            <div id="registerError" class="error hidden"></div>
        </div>

        <!-- Modal de Documentos Legais -->
        <div id="legalModal" class="legal-modal hidden">
            <div class="legal-modal-content">
                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;">
                    <h3 id="legalModalTitle">Documento Legal</h3>
                    <button onclick="hideLegalModal()" style="background: #dc3545; color: white; border: none; padding: 8px 12px; border-radius: 5px; cursor: pointer;">‚úï</button>
                </div>
                <div id="legalModalContent">
                    <!-- Conte√∫do ser√° carregado dinamicamente -->
                </div>
            </div>
        </div>
    </div>

    <script>
        // === BEB√ä SMART - SISTEMA REAL FUNCIONANDO ===
        // Cadastro real integrado com N8N + Supabase + WhatsApp

        // Vari√°veis globais
        let currentUser = null;

        // Inicializa√ß√£o
        window.addEventListener('load', function() {
            console.log('üöÄ Beb√™ Smart REAL carregado com sucesso!');
            console.log('‚úÖ Sistema de cadastro conectado com N8N');
            console.log('‚úÖ Integra√ß√£o Supabase + WhatsApp funcionando');
            console.log('üîó Webhook: https://n8neditor.streamimpactoia.com.br/webhook/cadastro-bebe-smart');
            checkTermsAcceptance();
        });

        // Verificar aceita√ß√£o dos termos
        function checkTermsAcceptance() {
            const termsAccepted = localStorage.getItem('bebeSmartTermsAccepted');
            if (!termsAccepted) {
                setTimeout(() => {
                    showLegalModal('termos');
                }, 3000);
            }
        }

        // ===============================
        // FUN√á√ÉO DE CADASTRO REAL - CONECTADA COM N8N
        // ===============================
        async function register() {
            const nome = document.getElementById('registerName').value;
            const email = document.getElementById('registerEmail').value;
            const telefone = document.getElementById('registerPhone').value;
            const senha = document.getElementById('registerPassword').value;
            const termsAccepted = document.getElementById('acceptTerms').checked;

            // Valida√ß√µes b√°sicas
            if (!nome || !email || !telefone || !senha) {
                showError('registerError', 'Preencha todos os campos');
                return;
            }

            if (!termsAccepted) {
                showError('registerError', '√â necess√°rio aceitar os Termos de Uso e Pol√≠tica de Privacidade');
                return;
            }

            if (senha.length < 6) {
                showError('registerError', 'A senha deve ter pelo menos 6 caracteres');
                return;
            }

            // Mostrar loading
            const btn = event.target;
            const originalText = btn.textContent;
            btn.disabled = true;
            btn.textContent = 'Criando conta...';

            try {
                console.log('üì° Enviando dados para N8N...');
                
                const response = await fetch('https://n8neditor.streamimpactoia.com.br/webhook/cadastro-bebe-smart', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({
                        nome: nome,
                        email: email,
                        telefone: telefone,
                        senha: senha
                    })
                });

                console.log('üì° Resposta recebida:', response.status);
                console.log('üì° Headers:', response.headers.get('content-type'));
                
                // Verificar se √© JSON v√°lido
                const contentType = response.headers.get('content-type');
                let result;
                
                if (contentType && contentType.includes('application/json')) {
                    result = await response.json();
                } else {
                    // Se n√£o for JSON, pegar como texto
                    const textResult = await response.text();
                    console.log('üì¶ Resposta como texto:', textResult);
                    try {
                        result = JSON.parse(textResult);
                    } catch (e) {
                        console.log('‚ùå Erro ao fazer parse JSON:', e);
                        result = { status: 'error', message: 'Resposta inv√°lida do servidor' };
                    }
                }
                
                console.log('üì¶ Dados processados:', result);

                if (result && result.status === 'success') {
                    // ‚úÖ SUCESSO - Usu√°rio criado
                    console.log('‚úÖ Usu√°rio criado com sucesso!');
                    
                    // Garantir que next_steps √© string
                    const nextSteps = typeof result.next_steps === 'string' ? result.next_steps : 'Fa√ßa login e escolha seu plano!';
                    const message = typeof result.message === 'string' ? result.message : 'Cadastro realizado com sucesso!';
                    
                    document.getElementById('registerError').innerHTML = `
                        <div class="success">
                            <h4>üéâ Cadastro realizado com sucesso!</h4>
                            <p><strong>Bem-vindo(a), ${nome}!</strong></p>
                            <p><strong>üì± ${message}</strong></p>
                            <p><strong>Pr√≥ximos passos:</strong> ${nextSteps}</p>
                            <p style="font-size: 12px; margin-top: 10px; color: #6c757d;">
                                <strong>‚úÖ Usu√°rio criado no Supabase</strong><br>
                                <strong>üì± WhatsApp enviado via Evolution API</strong><br>
                                <strong>üîí Dados protegidos conforme LGPD</strong><br>
                                <strong>üöÄ Sistema totalmente funcional!</strong>
                                ${result.user_id ? `<br><strong>üÜî ID:</strong> ${result.user_id}` : ''}
                            </p>
                        </div>
                    `;
                    document.getElementById('registerError').classList.remove('hidden');
                    document.getElementById('registerError').classList.remove('error');
                    
                    // Limpar formul√°rio
                    document.getElementById('registerName').value = '';
                    document.getElementById('registerEmail').value = '';
                    document.getElementById('registerPhone').value = '';
                    document.getElementById('registerPassword').value = '';
                    document.getElementById('acceptTerms').checked = false;
                    
                    // Redirecionar para login ap√≥s 6 segundos
                    setTimeout(() => {
                        showLogin();
                        document.getElementById('loginError').innerHTML = `
                            <div class="success">
                                <p><strong>üéâ Conta criada com sucesso!</strong> Agora fa√ßa login para continuar!</p>
                                <p><strong>üì± N√£o esque√ßa de verificar seu WhatsApp!</strong></p>
                            </div>
                        `;
                        document.getElementById('loginError').classList.remove('hidden');
                        document.getElementById('loginError').classList.remove('error');
                    }, 6000);
                    
                } else {
                    // ‚ùå ERRO do servidor (email j√° existe, etc.)
                    const errorMessage = (result && typeof result.message === 'string') ? result.message : 'Erro ao criar conta. Tente novamente.';
                    console.log('‚ùå Erro:', errorMessage);
                    showError('registerError', errorMessage);
                }

            } catch (error) {
                // ‚ùå ERRO de conex√£o
                console.error('‚ùå Erro de conex√£o:', error);
                showError('registerError', 'Erro de conex√£o com o servidor. Verifique sua internet e tente novamente.');
            }

            // Restaurar bot√£o
            btn.disabled = false;
            btn.textContent = originalText;
        }

        // ===============================
        // DEMAIS FUN√á√ïES DO SISTEMA
        // ===============================

        function login() {
            const email = document.getElementById('loginEmail').value;
            const password = document.getElementById('loginPassword').value;
            
            if (!email || !password) {
                showError('loginError', 'Preencha todos os campos');
                return;
            }

            // Login demo (em breve ser√° integrado tamb√©m)
            currentUser = { email: email, name: email.split('@')[0] };
            alert('üéâ Login realizado! Em breve esta fun√ß√£o tamb√©m ser√° integrada com o sistema real.');
        }

        // Navega√ß√£o entre telas
        function hideAllScreens() {
            document.getElementById('loginScreen').classList.add('hidden');
            document.getElementById('registerScreen').classList.add('hidden');
        }

        function showLogin() {
            hideAllScreens();
            document.getElementById('loginScreen').classList.remove('hidden');
        }

        function showRegister() {
            hideAllScreens();
            document.getElementById('registerScreen').classList.remove('hidden');
        }

        // Mostrar modal legal
        function showLegalModal(type) {
            const modal = document.getElementById('legalModal');
            const title = document.getElementById('legalModalTitle');
            const content = document.getElementById('legalModalContent');
            
            if (type === 'termos') {
                title.textContent = 'Termos de Uso - Beb√™ Smart';
                content.innerHTML = getTermsContent();
            } else if (type === 'privacidade') {
                title.textContent = 'Pol√≠tica de Privacidade - Beb√™ Smart';
                content.innerHTML = getPrivacyContent();
            }
            
            modal.classList.remove('hidden');
        }

        // Esconder modal legal
        function hideLegalModal() {
            document.getElementById('legalModal').classList.add('hidden');
        }

        // Conte√∫do dos termos de uso
        function getTermsContent() {
            return `
                <h4 style="color: #dc3545;">‚ö†Ô∏è LIMITA√á√ïES IMPORTANTES:</h4>
                <ul>
                    <li><strong>N√ÉO √© servi√ßo m√©dico</strong> ou de sa√∫de</li>
                    <li><strong>N√ÉO realiza diagn√≥sticos</strong> de qualquer natureza</li>
                    <li><strong>N√ÉO substitui</strong> consultas com pediatras</li>
                    <li><strong>N√ÉO deve ser usado</strong> em emerg√™ncias m√©dicas</li>
                </ul>
                
                <h4 style="color: #28a745;">‚úÖ O QUE √â O BEB√ä SMART:</h4>
                <ul>
                    <li><strong>Ferramenta educativa</strong> para acompanhamento do desenvolvimento</li>
                    <li><strong>Sistema organizacional</strong> de informa√ß√µes sobre beb√™s</li>
                    <li><strong>Sugest√µes de atividades</strong> baseadas em literatura cient√≠fica</li>
                    <li><strong>Lembretes</strong> de consultas e cuidados</li>
                </ul>
                
                <div style="background: #f8d7da; border: 1px solid #dc3545; border-radius: 8px; padding: 15px; margin: 20px 0;">
                    <h5 style="color: #721c24;">üö® EM EMERG√äNCIAS:</h5>
                    <p style="color: #721c24; margin: 0;">
                        <strong>NUNCA use este app em emerg√™ncias m√©dicas!</strong><br>
                        Ligue imediatamente: <strong>192 (SAMU)</strong> ou <strong>193 (Bombeiros)</strong><br>
                        Procure o pronto-socorro mais pr√≥ximo.
                    </p>
                </div>
                
                <h4>üìã PROTE√á√ÉO DE DADOS</h4>
                <p>Dados de crian√ßas recebem prote√ß√£o especial conforme LGPD. Apenas pais/respons√°veis legais podem cadastrar e gerenciar informa√ß√µes dos filhos.</p>
                
                <div style="text-align: center; margin-top: 30px;">
                    <button onclick="acceptTerms()" class="btn" style="width: auto; margin: 10px;">
                        ‚úÖ Li e Aceito os Termos
                    </button>
                </div>
            `;
        }

        // Conte√∫do da pol√≠tica de privacidade
        function getPrivacyContent() {
            return `
                <h4 style="color: #17a2b8;">üîí PROTE√á√ÉO DE DADOS</h4>
                <p>O Beb√™ Smart est√° comprometido com a prote√ß√£o rigorosa da privacidade, especialmente de dados de crian√ßas e adolescentes.</p>
                
                <h4>üë∂ PROTE√á√ÉO ESPECIAL DE MENORES</h4>
                <ul>
                    <li><strong>Consentimento espec√≠fico</strong> dos pais/respons√°veis (LGPD Art. 14)</li>
                    <li><strong>Coleta m√≠nima</strong> de dados essenciais para o servi√ßo</li>
                    <li><strong>Criptografia adicional</strong> para dados de menores</li>
                    <li><strong>Acesso restrito</strong> por colaboradores autorizados</li>
                    <li><strong>Exclus√£o priorit√°ria</strong> quando solicitada</li>
                </ul>
                
                <h4>üõ°Ô∏è SEGURAN√áA</h4>
                <ul>
                    <li><strong>Criptografia AES-256</strong> para dados sens√≠veis</li>
                    <li><strong>HTTPS/TLS 1.3</strong> para transmiss√£o</li>
                    <li><strong>Backup criptografado</strong> em m√∫ltiplas localidades</li>
                    <li><strong>Monitoramento 24/7</strong> de seguran√ßa</li>
                    <li><strong>Acesso limitado</strong> por fun√ß√£o</li>
                </ul>
                
                <h4>üìä N√ÉO COMPARTILHAMOS COM:</h4>
                <ul>
                    <li>‚ùå Empresas de marketing ou publicidade</li>
                    <li>‚ùå Brokers de dados ou similares</li>
                    <li>‚ùå Redes sociais para fins comerciais</li>
                    <li>‚ùå Terceiros n√£o autorizados</li>
                </ul>
                
                <h4>‚öñÔ∏è SEUS DIREITOS (LGPD)</h4>
                <p>Voc√™ tem direito de:</p>
                <ul>
                    <li><strong>Confirmar</strong> se tratamos seus dados</li>
                    <li><strong>Acessar</strong> todos os dados pessoais</li>
                    <li><strong>Corrigir</strong> dados incorretos</li>
                    <li><strong>Excluir</strong> dados desnecess√°rios</li>
                    <li><strong>Transferir</strong> dados para outro controlador</li>
                    <li><strong>Revogar consentimento</strong> a qualquer momento</li>
                </ul>
                
                <h4>üìû CONTATO PARA DADOS</h4>
                <p>
                    <strong>DPO:</strong> dpo@bebesmart.com.br<br>
                    <strong>Privacidade:</strong> privacidade@bebesmart.com.br<br>
                    <strong>Prazo de resposta:</strong> at√© 15 dias √∫teis
                </p>
            `;
        }

        // Aceitar termos
        function acceptTerms() {
            localStorage.setItem('bebeSmartTermsAccepted', 'true');
            hideLegalModal();
            alert('‚úÖ Termos aceitos! Lembre-se: sempre consulte seu pediatra para orienta√ß√µes espec√≠ficas sobre seu beb√™.');
        }

        // Utilit√°rios
        function showError(elementId, message) {
            const element = document.getElementById(elementId);
            element.innerHTML = `<p>${message}</p>`;
            element.classList.remove('hidden');
            element.classList.add('error');
            element.classList.remove('success');
        }

        // Log de inicializa√ß√£o
        console.log('üéØ Beb√™ Smart - Sistema Real Funcionando');
        console.log('‚úÖ Conformidade total com LGPD');
        console.log('‚öñÔ∏è Disclaimers m√©dicos integrados');
        console.log('üîí Prote√ß√£o especial para dados de menores');
        console.log('ü§ñ IA educativa com base cient√≠fica');
        console.log('üì± WhatsApp autom√°tico integrado');
        console.log('üíæ Supabase para dados');
        console.log('üîß N8N para automa√ß√µes');
        console.log('üöÄ Sistema profissional completo!');
    </script>
</body>
</html>